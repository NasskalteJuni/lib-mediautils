<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Glare</title>
    <script src="../../dist/bundle.min.js"></script>
    <script src="./LocalSignalerMock.js">
    </script>
</head>
<body>
<button id="start">try generating glare</button>
<script>
    const a = new MediaUtilities.Connect({peer: 'b', name: 'a', signaller: signaller({self: 'a', peer: 'b', verbose: true})});
    const b = new MediaUtilities.Connect({peer: 'a', name: 'b', signaller: signaller({self: 'b', peer: 'a', verbose: true})});
    a.addEventListener('streamadded', (stream) => {
        console.log(stream, stream.active);
        const video = document.createElement('video');
        video.id = 'stream-b';
        video.autoplay = true;
        video.style.width = '640px';
        video.style.height = '480px';
        video.srcObject = stream;
        document.body.appendChild(video);
    });
    b.addEventListener('streamadded', (stream) => {
        console.log(stream, stream.active);
        const video = document.createElement('video');
        video.id = 'stream-a';
        video.autoplay = true;
        video.style.width = '640px';
        video.style.height = '480px';
        video.srcObject = stream;
        document.body.appendChild(video);
    });
    const button = document.getElementById("start");
    button.addEventListener('click', async function(){
        const stream = await navigator.mediaDevices.getUserMedia({video: true, audio: true});
        a.addMedia(stream);
        b.addMedia(stream);
    });
</script>
</body>
</html>